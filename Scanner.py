import subprocess

# Perform an NMAP TCP scan
subprocess.run(['nmap', '-sP', '-iL', 'ip_addresses'])

# Perform an NMAP TCP SYN scan
subprocess.run(['nmap', '-sSV', '-Pn', '-iL', 'ip_addresses', '-oG', 'nmap_tcp'])

# Parse NMAP TCP SYN scan
subprocess.run(['python', '/scripts/nmap-parser', 'nmap_tcp'])

# Perform an NMAP UDP scan
subprocess.run(['nmap', '-iL', 'ip_addresses', '-sUV', '-Pn', '-p', '53,69,123,161,500', '-oG', 'nmap_udp'])

# Parse NMAP UDP scan
subprocess.run(['python', '/scripts/nmap-parser', 'nmap_udp'])

# Perform ICMP Echo Request
subprocess.run(['nmap', '-sn', '-PE', '-PP', '-PM', '-iL', 'ip_addresses', '--reason'])

# Test open ports based on NMAP scan
ip_address = input("Enter IP address: ")
filename = input("Enter file name: ")

if subprocess.call(['nc', '-zvw3', ip_address, '22']) == 0:
    subprocess.run(['ssh', '-p', '22', ip_address])

if subprocess.call(['nc', '-zvw3', ip_address, '23']) == 0:
    subprocess.run(['telnet', ip_address, '23'])

if subprocess.call(['nc', '-zvw3', ip_address, '80']) == 0:
    filename = input("Enter file name: ")
    with open(f"HTTP_{filename}.txt", 'w') as file:
        subprocess.run(['curl', '-I', f'http://{ip_address}'], stdout=file)

if subprocess.call(['nc', '-zvw3', ip_address, '443']) == 0:
    filename = input("Enter file name: ")
    with open(f"SSL_{filename}.txt", 'w') as file:
        subprocess.run(['sslscan', '--no-failed', ip_address], stdout=file)

if subprocess.call(['nc', '-zvw3', ip_address, '161']) == 0:
    subprocess.run(['snmp-check', '-t', ip_address, '>', f'snmp_{ip_address}.txt'])

if subprocess.call(['nc', '-zvw3', ip_address, '123']) == 0:
    subprocess.run(['ntpq', '-c', 'readvar', ip_address])

if subprocess.call(['nc', '-zvw3', ip_address, '500']) == 0:
    psk_file = input("Enter PSK file: ")
    subprocess.run(['ike-scan', '-M', '--pskcrack', '--aggressive', '--id=peer', '-P', psk_file, ip_address])
    with open(psk_file, 'r') as file:
        subprocess.run(['psk-crack', '-d', '/usr/share/ike-scan/psk-crack-dictionary'], stdin=file)

domain = input("Enter domain: ")

if subprocess.call(['nc', '-zvw3', ip_address, '53']) == 0:
    subprocess.run(['dig', '@dns', domain, 'any'])
    subprocess.run(['dig', '@dns', domain, 'axfr'])

if subprocess.call(['nc', '-zvw3', ip_address, '5000']) == 0:
    subprocess.run(['curl', '-I', f'http://{ip_address}:5000'])

if subprocess.call(['nc', '-zvw3', ip_address, '6000']) == 0:
    subprocess.run(['curl', '-I', f'http://{ip_address}:6000'])

if subprocess.call(['nc', '-zvw3', ip_address, '8080']) == 0:
    filename = input("Enter file name: ")
    with open(f"HTTPS_{filename}.txt", 'w') as file:
        subprocess.run(['curl', '-I', f'https://{ip_address}:8080'], stdout=file)
